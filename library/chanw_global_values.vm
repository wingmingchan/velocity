#*
《code》
《copyright》
Author: Wing Ming Chan
Copyright (c) 2017 Wing Ming Chan <chanw@upstate.edu>
MIT Licensed
Modification history:
3/7/2017 Changed $master_site_name to $core_site_name
2/24/2017 Added names of setup formats.
2/1/2017 Added more date and calendar variables.
《/copyright》
《documentation id=“top”》
《h2》Introduction《/h2》
《p》This format defines global values used throughout the entire library.《/p》
《/documentation》
*#
#set( $core_site_name = "_common_assets" )

#import( 'formats/library/velocity/chanw_object_creator' )
#import( 'formats/library/velocity/chanw_display_velocity_code' )

## special characters
#define( $chanwDOUBLE_HASH )$_EscapeTool.getH()$_EscapeTool.getH()#end
#define( $chanwNEWLINE )$_EscapeTool.n#end
#define( $DOUBLE_HASH )$_EscapeTool.getH()$_EscapeTool.getH()#end
#define( $NEWLINE )$_EscapeTool.n#end

## HTML tags
#define( $S_DIV )<div>#end
#define( $E_DIV )</div>#end
#define( $S_H1 )<h1>#end
#define( $E_H1 )</h1>#end
#define( $S_H2 )<h2>#end
#define( $E_H2 )</h2>#end
#define( $S_H3 )<h3>#end
#define( $E_H3 )</h3>#end
#define( $S_LI )<li>#end
#define( $E_LI )</li>#end
#define( $S_P )<p>#end
#define( $E_P )</p>#end
#define( $S_PRE )<pre>#end
#define( $E_PRE )</pre>#end
#define( $S_UL )<ul>#end
#define( $E_UL )</ul>#end
#define( $BR )<br/>#end
#define( $HR )<hr class="lightgray"/>#end

## names of setup formats
#set( $MASTER_SETUP_FORMAT_NAME = "master_setup" )
#set( $DESIGN_SETUP_FORMAT_NAME = "setup" )
#set( $SITE_SETUP_FORMAT_NAME   = "setup" )
#set( $FOLDER_SETUP_FORMAT_NAME = "setup" )

## strings for documentation use
#set( $SOURCE_CODE = "The Source Code" )

## number used in loops
#set( $INTEGER_MAX_VALUE = 50000 )

## java class names used for comparison
#set( $COM_CASCADE_BLOCK_API_CLASS_NAME         = "com.hannonhill.cascade.api.adapters.XHTMLDataDefinitionBlockAPIAdapter" )
#set( $COM_CASCADE_METADATA_CLASS_NAME          = "com.hannonhill.cascade.api.adapters.MetadataAPIAdapter" )
#set( $COM_CASCADE_PAGE_API_CLASS_NAME          = "com.hannonhill.cascade.api.adapters.PageAPIAdapter" )
#set( $COM_CASCADE_STRUCTURED_DATA_NODE_CLASS_NAME = "com.hannonhill.cascade.api.adapters.StructuredDataNodeAPIAdapter" )
#set( $COM_CASCADE_STRUCTURED_DATA_LIST_CLASS_NAME = "[Lcom.hannonhill.cascade.api.asset.common.StructuredDataNode;" )
#set( $JAVA_LANG_INTEGER_CLASS_NAME             = 'java.lang.Integer' )
#set( $JAVA_LANG_STRING_CLASS_NAME              = 'java.lang.String' )
#set( $JAVA_LANG_CLASS_CLASS_NAME               = 'java.lang.Class' )
#set( $JAVA_UTIL_ARRAY_LIST_CLASS_NAME          = 'java.util.ArrayList' )
#set( $JAVA_UTIL_LINKEDHASHMAP_CLASS_NAME       = 'java.util.LinkedHashMap' )
#set( $JAVA_UTIL_HASHMAP_CLASS_NAME             = 'java.util.HashMap' )
#set( $JAVA_SQL_STATEMENT_CLASS_NAME            = 'java.sql.Statement' )
#set( $JAVA_SQL_RESULT_SET_CLASS_NAME           = 'java.sql.ResultSet' )
#set( $ORG_JDOM_DOCUMENT_CLASS_NAME             = 'org.jdom.Document' )
#set( $ORG_JDOM_ELEMENT_CLASS_NAME              = 'org.jdom.Element' )

## cascade pseudo tags
#set( $S_SYSTEM_ASSET       = "[" + "system-asset]" )
#set( $E_SYSTEM_ASSET       = "[" + "/system-asset]" )
#set( $S_SYSTEM_ASSET_LOCAL = "[" + "system-asset:local]" )
#set( $E_SYSTEM_ASSET_LOCAL = "[" + "/system-asset:local]" )

## cascade element names
#set( $cascadeXML_ELEMENT_AUTHOR                = 'author' )
#set( $cascadeXML_ELEMENT_CREATED_BY            = 'created-by' )
#set( $cascadeXML_ELEMENT_CREATED_ON            = 'created-on' )
#set( $cascadeXML_ELEMENT_DESCRIPTION           = 'description' )
#set( $cascadeXML_ELEMENT_DISPLAY_NAME          = 'display-name' )
#set( $cascadeXML_ELEMENT_DYNAMIC_METADATA      = 'dynamic-metadata' )
#set( $cascadeXML_ELEMENT_END_DATE              = 'end-date' )
#set( $cascadeXML_ELEMENT_FILE_SIZE             = 'file-size' )
#set( $cascadeXML_ELEMENT_IS_PUBLISHED          = 'is-published' )
#set( $cascadeXML_ELEMENT_KEYWORDS              = 'keywords' )
#set( $cascadeXML_ELEMENT_LAST_MODIFIED_BY      = 'last-modified-by' )
#set( $cascadeXML_ELEMENT_LAST_MODIFIED         = 'last-modified' )
#set( $cascadeXML_ELEMENT_LAST_PUBLISHED_BY     = 'last-published-by' )
#set( $cascadeXML_ELEMENT_LAST_PUBLISHED_ON     = 'last-published-on' )
#set( $cascadeXML_ELEMENT_LINK                  = 'link' )
#set( $cascadeXML_ELEMENT_NAME                  = 'name' )
#set( $cascadeXML_ELEMENT_PATH                  = 'path' )
#set( $cascadeXML_ELEMENT_PAGE_XHTML            = 'page-xhtml' )
#set( $cascadeXML_ELEMENT_PAGE_XHTML            = 'page-xhtml' )
#set( $cascadeXML_ELEMENT_REVIEW_DATE           = 'review-date' )
#set( $cascadeXML_ELEMENT_SITE                  = 'site' )
#set( $cascadeXML_ELEMENT_START_DATE            = 'start-date' )
#set( $cascadeXML_ELEMENT_SUMMARY               = 'summary' )
#set( $cascadeXML_ELEMENT_SYSTEM_BLOCK          = 'system-block' )
#set( $cascadeXML_ELEMENT_SYSTEM_DATA_STRUCTURE = 'system-data-structure' )
#set( $cascadeXML_ELEMENT_SYSTEM_FILE           = 'system-file' )
#set( $cascadeXML_ELEMENT_SYSTEM_FOLDER         = 'system-folder' )
#set( $cascadeXML_ELEMENT_SYSTEM_INDEX_BLOCK    = 'system-index-block' )
#set( $cascadeXML_ELEMENT_SYSTEM_PAGE           = 'system-page' )
#set( $cascadeXML_ELEMENT_SYSTEM_SYMLINK        = 'system-symlink' )
#set( $cascadeXML_ELEMENT_SYSTEM_XML            = 'system-xml' )
#set( $cascadeXML_ELEMENT_TEASER                = 'teaser' )
#set( $cascadeXML_ELEMENT_TITLE                 = 'title' )
#set( $chanwFolderContainedAssets = [ $cascadeXML_ELEMENT_SYSTEM_BLOCK, 
    $cascadeXML_ELEMENT_SYSTEM_FILE, $cascadeXML_ELEMENT_SYSTEM_FOLDER,
    $cascadeXML_ELEMENT_SYSTEM_PAGE, $cascadeXML_ELEMENT_SYSTEM_SYMLINK ] )

## RSS
#set( $rssXML_ELEMENT_CHANNEL                   = 'channel' )
#set( $rssXML_ELEMENT_DESCRIPTION               = 'description' )
#set( $rssXML_ELEMENT_GUID                      = 'guid' )
#set( $rssXML_ELEMENT_ITEM                      = 'item' )
#set( $rssXML_ELEMENT_LINK                      = 'link' )
#set( $rssXML_ELEMENT_PUB_DATE                  = 'pubDate' )
#set( $rssXML_ELEMENT_TITLE                     = 'title' )

## Cascade API types
#set( $CASCADE_API_BLOCK_TYPE     = $_FieldTool.in( "com.hannonhill.cascade.model.dom.identifier.EntityTypes" ).TYPE_BLOCK )
#set( $CASCADE_API_FILE_TYPE      = $_FieldTool.in( "com.hannonhill.cascade.model.dom.identifier.EntityTypes" ).TYPE_FILE )
#set( $CASCADE_API_FOLDER_TYPE    = $_FieldTool.in( "com.hannonhill.cascade.model.dom.identifier.EntityTypes" ).TYPE_FOLDER )
#set( $CASCADE_API_FORMAT_TYPE    = $_FieldTool.in( "com.hannonhill.cascade.model.dom.identifier.EntityTypes" ).TYPE_FORMAT )
#set( $CASCADE_API_PAGE_TYPE      = $_FieldTool.in( "com.hannonhill.cascade.model.dom.identifier.EntityTypes" ).TYPE_PAGE )
#set( $CASCADE_API_REFERENCE_TYPE = $_FieldTool.in( "com.hannonhill.cascade.model.dom.identifier.EntityTypes" ).TYPE_REFERENCE )
#set( $CASCADE_API_SYMLINK_TYPE   = $_FieldTool.in( "com.hannonhill.cascade.model.dom.identifier.EntityTypes" ).TYPE_SYMLINK )

## element to Cascade type map
#set( $CASCADE_TYPE_ELEMENT_MAP = {
    "system-block":  $CASCADE_API_BLOCK_TYPE,
    "system-file":   $CASCADE_API_FILE_TYPE,
    "system-folder": $CASCADE_API_FOLDER_TYPE,
    "system-page":   $CASCADE_API_PAGE_TYPE,
    "system-symlink":$CASCADE_API_SYMLINK_TYPE
} )

## Cascade API class strings
#set( $CASCADE_API_DataBlock_CLASS_NAME    = "com.hannonhill.cascade.api.adapters.XHTMLDataDefinitionBlockAPIAdapter" )
#set( $CASCADE_API_FeedBlock_CLASS_NAME    = "com.hannonhill.cascade.api.adapters.FeedBlockAPIAdapter" )
#set( $CASCADE_API_File_CLASS_NAME         = "com.hannonhill.cascade.api.adapters.FileAPIAdapter" )
#set( $CASCADE_API_Folder_CLASS_NAME       = "com.hannonhill.cascade.api.adapters.FolderAPIAdapter" )
#set( $CASCADE_API_Page_CLASS_NAME         = "com.hannonhill.cascade.api.adapters.PageAPIAdapter" )
#set( $CASCADE_API_ScriptFormat_CLASS_NAME = "com.hannonhill.cascade.api.adapters.ScriptFormatAPIAdapter" )
#set( $CASCADE_API_Symlink_CLASS_NAME      = "com.hannonhill.cascade.api.adapters.SymlinkAPIAdapter" )
#set( $CASCADE_API_TextBlock_CLASS_NAME    = "com.hannonhill.cascade.api.adapters.TextBlockAPIAdapter" )
#set( $CASCADE_API_XMLBlock_CLASS_NAME     = "com.hannonhill.cascade.api.adapters.XMLBlockAPIAdapter" )

## Cascade API Asset
#set( $DataBlockPropertyMap = {
    "DataBlockCreatedBy":             "CreatedBy",
    "DataBlockCreatedOn":             "CreatedOn",
    "DataBlockDataDefinitionPath":    "DataDefinitionPath",
	"DataBlockFolderOrder":           "FolderOrder",
	"DataBlockId":                    "Identifier.Id",
	"DataBlockIdentifier":            "Identifier",
	"DataBlockLastModified":          "LastModified",
	"DataBlockLastModifiedBy":        "LastModifiedBy",
	"DataBlockMetadata":              "Metadata",
	"DataBlockName":                  "Name",
	"DataBlockParentFolder":          "ParentFolder",
	"DataBlockParentFolderIdentifier":"ParentFolderIdentifier",
	"DataBlockPath":                  "Path",
	"DataBlockSiteId":                "SiteId",
	"DataBlockSiteName":              "SiteName",
	"DataBlockSiteStructuredData":    "StructuredData",
	"DataBlockType":                  "Identifier.Type",
	"DataBlockXHTML":                 "XHTML",
	"DataBlockXHTMLAsXMLElement":     "XHTMLAsXMLElement"
} )

#set( $FeedBlockPropertyMap = {
    "FeedBlockCreatedBy":             "CreatedBy",
	"FeedBlockCreatedOn":             "CreatedOn",
	"FeedBlockFeed":                  "Feed",
	"FeedBlockFeedURL":               "FeedURL",
	"FeedBlockFolderOrder":           "FolderOrder",
	"FeedBlockId":                    "Identifier.Id",
	"FeedBlockIdentifier":            "Identifier",
	"FeedBlockLastModified":          "LastModified",
	"FeedBlockLastModifiedBy":        "LastModifiedBy",
	"FeedBlockMetadata":              "Metadata",
	"FeedBlockName":                  "Name",
	"FeedBlockParentFolder":          "ParentFolder",
	"FeedBlockParentFolderIdentifier":"ParentFolderIdentifier",
	"FeedBlockPath":                  "Path",
	"FeedBlockSiteId":                "SiteId",
	"FeedBlockSiteName":              "SiteName",
	"FeedBlockType":                  "Identifier.Type"
} )

## FileData, FileText are left out
#set( $FilePropertyMap = {
    "FileCreatedBy":             "CreatedBy",
	"FileCreatedOn":             "CreatedOn",
	"FileFileSize":              "FileSize",
	"FileFolderOrder":           "FolderOrder",
	"FileId":                    "Identifier.Id",
	"FileIdentifier":            "Identifier",
	"FileLastModified":          "LastModified",
	"FileLastModifiedBy":        "LastModifiedBy",
	"FileLastPublishedBy":       "LastPublishedBy",
	"FileLastPublishedOn":       "LastPublishedOn",
	"FileLlink":                 "Link",
	"FileMetadata":              "Metadata",
	"FileName":                  "Name",
	"FileParentFolder":          "ParentFolder",
	"FileParentFolderIdentifier":"ParentFolderIdentifier",
	"FilePath":                  "Path",
	"FileShouldBeIndexed":       "ShouldBeIndexed",
	"FileShouldBePublished":     "ShouldBePublished",
	"FileSiteId":                "SiteId",
	"FileSiteName":              "SiteName",
	"FileType":                  "Identifier.Type"
} )

#set( $FolderPropertyMap = {
	"FolderChildren":              "Children",
	"FolderChildrenIdentifiers":   "ChildrenIdentifiers",
	"FolderChildrenSize":          "Children.size()",
	"FolderCreatedBy":             "CreatedBy",
	"FolderCreatedOn":             "CreatedOn",
	"FolderFolderOrder":           "FolderOrder",
	"FolderId":                    "Identifier.Id",
	"FolderIdentifier":            "Identifier",
	"FolderisNoWorkflowRequired":  "isNoWorkflowRequired()",
	"FolderLastModified":          "LastModified",
	"FolderLastModifiedBy":        "LastModifiedBy",
	"FolderLink":                  "Link",
	"FolderMetadata":              "Metadata",
	"FolderName":                  "Name",
	"FolderNoWorkflowRequired":    "NoWorkflowRequired",
	"FolderParentFolder":          "ParentFolder",
	"FolderParentFolderIdentifier":"ParentFolderIdentifier",
	"FolderPath":                  "Path",
	"FolderSiteId":                "SiteId",
	"FolderSiteName":              "SiteName",
	"FolderType":                  "Identifier.Type"
} )

#set( $PagePropertyMap = {
	"PageCreatedBy":             "CreatedBy",
	"PageCreatedOn":             "CreatedOn",
	"PageDataDefinitionPath":    "DataDefinitionPath",
	"PageFolderOrder":           "FolderOrder",
	"PageId":                    "Identifier.Id",
	"PageIdentifier":            "Identifier",
	"PageLastModified":          "LastModified",
	"PageLastModifiedBy":        "LastModifiedBy",
	"PageLastPublishedBy":       "LastPublishedBy",
	"PageLastPublishedOn":       "LastPublishedOn",
	"PageLink":                  "Link",
	"PageMetadata":              "Metadata",
	"PageName":                  "Name",
	"PageParentFolder":          "ParentFolder",
	"PageParentFolderIdentifier":"ParentFolderIdentifier",
	"PagePath":                  "Path",
	"PageShouldBeIndexed":       "ShouldBeIndexed",
	"PageShouldBePublished":     "ShouldBePublished",
	"PageSiteId":                "SiteId",
	"PageSiteName":              "SiteName",
	"PageSiteStructuredData":    "StructuredData",
	"PageType":                  "Identifier.Type",
	"PageXHTML":                 "XHTML",
	"PageXHTMLAsXMLElement":     "XHTMLAsXMLElement"
} )

#set( $ScriptFormatPropertyMap = {
	"ScriptFormatCreatedBy":             "CreatedBy",
	"ScriptFormatCreatedOn":             "CreatedOn",
	"ScriptFormatFolderOrder":           "FolderOrder",
	"ScriptFormatId":                    "Identifier.Id",
	"ScriptFormatIdentifier":            "Identifier",
	"ScriptFormatLastModified":          "LastModified",
	"ScriptFormatLastModifiedBy":        "LastModifiedBy",
	"ScriptFormatName":                  "Name",
	"ScriptFormatParentFolder":          "ParentFolder",
	"ScriptFormatParentFolderIdentifier":"ParentFolderIdentifier",
	"ScriptFormatPath":                  "Path",
	"ScriptFormatScript":                "Script",
	"ScriptFormatSiteId":                "SiteId",
	"ScriptFormatSiteName":              "SiteName",
	"ScriptFormatType":                  "Identifier.Type"
} )

#set( $SymlinkPropertyMap = {
    "SymlinkCreatedBy":             "CreatedBy",
	"SymlinkCreatedOn":             "CreatedOn",
	"SymlinkFolderOrder":           "FolderOrder",
	"SymlinkId":                    "Identifier.Id",
	"SymlinkIdentifier":            "Identifier",
	"SymlinkLastModified":          "LastModified",
	"SymlinkLastModifiedBy":        "LastModifiedBy",
	"SymlinkLink":                  "Link",
	"SymlinkMetadata":              "Metadata",
	"SymlinkName":                  "Name",
	"SymlinkParentFolder":          "ParentFolder",
	"SymlinkParentFolderIdentifier":"ParentFolderIdentifier",
	"SymlinkPath":                  "Path",
	"SymlinkSiteId":                "SiteId",
	"SymlinkSiteName":              "SiteName",
	"SymlinkType":                  "Identifier.Type"
} )

#set( $TextBlockPropertyMap = {
    "TextBlockCreatedBy":             "CreatedBy",
	"TextBlockCreatedOn":             "CreatedOn",
	"TextBlockFolderOrder":           "FolderOrder",
	"TextBlockId":                    "Identifier.Id",
	"TextBlockIdentifier":            "Identifier",
	"TextBlockLastModified":          "LastModified",
	"TextBlockLastModifiedBy":        "LastModifiedBy",
	"TextBlockMetadata":              "Metadata",
	"TextBlockName":                  "Name",
	"TextBlockParentFolder":          "ParentFolder",
	"TextBlockParentFolderIdentifier":"ParentFolderIdentifier",
	"TextBlockPath":                  "Path",
	"TextBlockSiteId":                "SiteId",
	"TextBlockSiteName":              "SiteName",
	"TextBlockText":                  "Text",
	"TextBlockType":                  "Identifier.Type"
} )

#set( $XMLBlockPropertyMap = {
    "XMLBlockCreatedBy":             "CreatedBy",
	"XMLBlockCreatedOn":             "CreatedOn",
	"XMLBlockFolderOrder":           "FolderOrder",
	"XMLBlockId":                    "Identifier.Id",
	"XMLBlockIdentifier":            "Identifier",
	"XMLBlockLastModified":          "LastModified",
	"XMLBlockLastModifiedBy":        "LastModifiedBy",
	"XMLBlockMetadata":              "Metadata",
	"XMLBlockName":                  "Name",
	"XMLBlockParentFolder":          "ParentFolder",
	"XMLBlockParentFolderIdentifier":"ParentFolderIdentifier",
	"XMLBlockPath":                  "Path",
	"XMLBlockSiteId":                "SiteId",
	"XMLBlockSiteName":              "SiteName",
	"XMLBlockType":                  "Identifier.Type",
	"XMLBlockXML":                   "Identifier.XML",
	"XMLBlockXMLAsXMLElement":       "XMLAsXMLElement"
} )



## HTML element names, used in processing data definition blocks
#* 'link', 'summary', 'title' are omitted from this list because they are used in Cascade.
Otherwise, when an element is encountered, it is assumed to be in a wysiwyg and the element
is part of the HTML markups.
*#
#set( $chanwHTMLElements = [
    'a', 'abbr', 'address', 'area', 'article', 'aside', 'audio', 
    'b', 'base', 'bdi', 'bdo', 'blockquote', 'body', 'br', 'button', 
    'canvas', 'caption', 'cite', 'code', 'col', 'colgroup',
    'datalist', 'dd', 'del', 'details', 'dfn', 'dialog',  'div','dl', 'dt',
    'em', 'embed', 'fieldset', 'figcaption', 'figure', 'footer', 'form',
    'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'head', 'header', 'hr', 'html',
    'i', 'iframe', 'img', 'input', 'ins', 'kdb', 'keygen',
    'label', 'legend', 'li',
    'main', 'map', 'mark', 'menu',  'menuitem', 'meta','meter', 'nav', 'noscript', 
    'object', 'ol', 'optgroup', 'option', 'output',
    'p', 'param', 'pre', 'progress', 'q', 'rp', 'rt', 'ruby', 
    's', 'samp', 'script', 'section', 'select', 'small', 'source', 'span', 'strong',
    'style', 'sub', 'sup', 
    'table', 'tbody', 'td', 'textarea', 'tfoot', 'th', 'thead', 'time',
    'tr','track', 'u', 'ul', 'var', 'video', 'wbr'
] )

## date and calendar
## fields
#set( $chanwYearField     = $_FieldTool.in( 'java.util.Calendar' ).YEAR )
#set( $chanwMonthField    = $_FieldTool.in( 'java.util.Calendar' ).MONTH )
#set( $chanwDayField      = $_FieldTool.in( 'java.util.Calendar' ).DATE )
#set( $chanwHourField     = $_FieldTool.in( 'java.util.Calendar' ).HOUR )
#set( $chanwMinuteField   = $_FieldTool.in( 'java.util.Calendar' ).MINUTE )
#set( $chanwSecondField   = $_FieldTool.in( 'java.util.Calendar' ).SECOND )
#set( $chanwAmPmField     = $_FieldTool.in( 'java.util.Calendar' ).AM_PM )

## today
#set( $chanwTodayDateObject          = $_DateTool.getSystemDate() )
#set( $chanwShortField = $_FieldTool.in( $chanwTodayDateObject ).SHORT )
#set( $chanwLongField  = $_FieldTool.in( $chanwTodayDateObject ).LONG )
#set( $chanwCalendarObject           = $_DateTool.getCalendar() )
#set( $chanwCurrentTimestampLong     = $_DateTool.getSystemTime() )
#set( $chanwCurrentTimestampString   = "" + $_DateTool.getSystemTime() )
#set( $chanwCurrentYearInt           = $_DateTool.getYear() )
#set( $chanwCurrentMonthInt          = $_DateTool.getMonth() )
#set( $chanwCurrentDayInt            = $_DateTool.getDay() )
#set( $chanwCurrentHourInt           = $_DateTool.getValue( $chanwHourField, $chanwTodayDateObject ) )
#set( $chanwCurrentMinuteInt         = $_DateTool.getValue( $chanwMinuteField, $chanwTodayDateObject ) )
#set( $chanwCurrentSecondInt         = $_DateTool.getValue( $chanwSecondField, $chanwTodayDateObject ) )
#set( $chanwCurrentAmPmString        = $_DateTool.getValue( $chanwAmPmField, $chanwTodayDateObject ) )
#set( $chanwCurrentDayOfWeekLongString  = $_DateTool.format( "EEEEE", $chanwTodayDateObject ) )
#set( $chanwCurrentDayOfWeekShortString = $_DateTool.format( "EEE", $chanwTodayDateObject ) )
#set( $chanwCurrentMonthLongString   = $_DateTool.format( "MMMMM", $chanwTodayDateObject ) )
#set( $chanwCurrentMonthMediumString = $_DateTool.format( "MMM", $chanwTodayDateObject ) )

## yesterday
#set( $chanwYesterdayCalObject = $chanwCalendarObject.clone() )
$chanwYesterdayCalObject.add( $chanwDayField, -1 )
#set( $chanwYesterdayDateObject = $_DateTool.toDate( $chanwYesterdayCalObject ) )
#set( $chanwYesterdayInt = $chanwYesterdayCalObject.get( $chanwDayField ) )
#set( $chanwYesterdayDayOfWeekLongString  = $_DateTool.format( "EEEEE", $chanwYesterdayDateObject ) )
#set( $chanwYesterdayDayOfWeekShortString = $_DateTool.format( "EEE", $chanwYesterdayDateObject ) )

## tomorrow
#set( $chanwTomorrowCalObject  = $chanwCalendarObject.clone() )
$chanwTomorrowCalObject.add( $chanwDayField, 1 )
#set( $chanwTomorrowDateObject = $_DateTool.toDate( $chanwTomorrowCalObject ) )
#set( $chanwTomorrowInt = $chanwTomorrowCalObject.get( $chanwDayField ) )
#set( $chanwTomorrowDayOfWeekLongString  = $_DateTool.format( "EEEEE", $chanwTomorrowDateObject ) )
#set( $chanwTomorrowDayOfWeekShortString = $_DateTool.format( "EEE", $chanwTomorrowDateObject ) )

## last month
#set( $chanwLastMonthCalObject = $chanwCalendarObject.clone() )
$chanwLastMonthCalObject.add( $chanwMonthField, -1 )
#set( $chanwLastMonthDateObject = $_DateTool.toDate( $chanwLastMonthCalObject ) )
#set( $chanwLastMonthInt = $chanwLastMonthCalObject.get( $chanwMonthField ) )
#set( $chanwLastMonthLongString  = $_DateTool.format( "MMMMM", $chanwLastMonthDateObject ) )
#set( $chanwLastMonthShortString = $_DateTool.format( "MMM", $chanwLastMonthDateObject ) )

## next month
#set( $chanwNextMonthCalObject = $chanwCalendarObject.clone() )
$chanwNextMonthCalObject.add( $chanwMonthField, 1 )
#set( $chanwNextMonthDateObject = $_DateTool.toDate( $chanwNextMonthCalObject ) )
#set( $chanwNextMonthInt = $chanwNextMonthCalObject.get( $chanwMonthField ) )
#set( $chanwNextMonthLongString  = $_DateTool.format( "MMMMM", $chanwNextMonthDateObject ) )
#set( $chanwNextMonthShortString = $_DateTool.format( "MMM", $chanwNextMonthDateObject ) )

## last year
#set( $chanwLastYearCalObject  = $chanwCalendarObject.clone() )
$chanwLastYearCalObject.add( $chanwYearField, -1 )
#set( $chanwLastYearDateObject = $_DateTool.toDate( $chanwLastYearCalObject ) )
#set( $chanwLastYearInt = $chanwCurrentYearInt - 1 )

## next year
#set( $chanwNextYearCalObject  = $chanwCalendarObject.clone() )
$chanwNextYearCalObject.add( $chanwYearField, 1 )
#set( $chanwNextYearDateObject = $_DateTool.toDate( $chanwNextYearCalObject ) )
#set( $chanwNextYearInt = $chanwCurrentYearInt + 1 )

#set( $rssItemVarElementMap = {
        'rssItemGuid':       $rssXML_ELEMENT_GUID,
        'rssItemTitle':      $rssXML_ELEMENT_TITLE,
        'rssItemLink':       $rssXML_ELEMENT_LINK,
        'rssItemPubDate':    $rssXML_ELEMENT_PUB_DATE,
        'rssItemDescription':$rssXML_ELEMENT_DESCRIPTION
    } )

#set( $systemBlockVarElementMap = {
        'systemBlockName':           $cascadeXML_ELEMENT_NAME,
        'systemBlockTitle':          $cascadeXML_ELEMENT_TITLE,
        'systemBlockSummary':        $cascadeXML_ELEMENT_SUMMARY,
        'systemBlockAuthor':         $cascadeXML_ELEMENT_AUTHOR,
        'systemBlockTeaser':         $cascadeXML_ELEMENT_TEASER,
        'systemBlockKeywords':       $cascadeXML_ELEMENT_KEYWORDS,
        'systemBlockDescription':    $cascadeXML_ELEMENT_DESCRIPTION,
        'systemBlockStartDate':      $cascadeXML_ELEMENT_START_DATE,
        'systemBlockEndDate':        $cascadeXML_ELEMENT_END_DATE,
        'systemBlockReviewDate':     $cascadeXML_ELEMENT_REVIEW_DATE,
        'systemBlockDisplayName':    $cascadeXML_ELEMENT_DISPLAY_NAME,
        'systemBlockPath':           $cascadeXML_ELEMENT_PATH,
        'systemBlockSite':           $cascadeXML_ELEMENT_SITE,
        'systemBlockCreatedBy':      $cascadeXML_ELEMENT_CREATED_BY,
        'systemBlockCreatedOn':      $cascadeXML_ELEMENT_CREATED_ON,
        'systemBlockLastModifiedBy': $cascadeXML_ELEMENT_LAST_MODIFIED_BY,
        'systemBlockLastModified':   $cascadeXML_ELEMENT_LAST_MODIFIED,
        'systemBlockDynamicMetadata':$cascadeXML_ELEMENT_DYNAMIC_METADATA,
        'systemBlockSystemDataStructure':$cascadeXML_ELEMENT_SYSTEM_DATA_STRUCTURE

    } )
   
#set( $systemFileVarElementMap = {
        'systemFileName':           $cascadeXML_ELEMENT_NAME,
        'systemFileTitle':          $cascadeXML_ELEMENT_TITLE,
        'systemFileSummary':        $cascadeXML_ELEMENT_SUMMARY,
        'systemFileAuthor':         $cascadeXML_ELEMENT_AUTHOR,
        'systemFileTeaser':         $cascadeXML_ELEMENT_TEASER,
        'systemFileKeywords':       $cascadeXML_ELEMENT_KEYWORDS,
        'systemFileDescription':    $cascadeXML_ELEMENT_DESCRIPTION,
        'systemFileStartDate':      $cascadeXML_ELEMENT_START_DATE,
        'systemFileEndDate':        $cascadeXML_ELEMENT_END_DATE,
        'systemFileReviewDate':     $cascadeXML_ELEMENT_REVIEW_DATE,
        'systemFileDisplayName':    $cascadeXML_ELEMENT_DISPLAY_NAME,
        'systemFileIsPublished':    $cascadeXML_ELEMENT_IS_PUBLISHED,
        'systemFileLastPublishedOn':$cascadeXML_ELEMENT_LAST_PUBLISHED_ON,
        'systemFileLastPublishedBy':$cascadeXML_ELEMENT_LAST_PUBLISHED_BY,
        'systemFilePath':           $cascadeXML_ELEMENT_PATH,
        'systemFileSite':           $cascadeXML_ELEMENT_SITE,
        'systemFileLink':           $cascadeXML_ELEMENT_LINK,
        'systemFileCreatedBy':      $cascadeXML_ELEMENT_CREATED_BY,
        'systemFileCreatedOn':      $cascadeXML_ELEMENT_CREATED_ON,
        'systemFileLastModifiedBy': $cascadeXML_ELEMENT_LAST_MODIFIED_BY,
        'systemFileLastModified':   $cascadeXML_ELEMENT_LAST_MODIFIED,
        'systemFileSize':           $cascadeXML_ELEMENT_FILE_SIZE,
        'systemFileDynamicMetadata':$cascadeXML_ELEMENT_DYNAMIC_METADATA
    } )

#set( $systemFolderVarElementMap = {
        'systemFolderName':           $cascadeXML_ELEMENT_NAME,
        'systemFolderIsPublished':    $cascadeXML_ELEMENT_IS_PUBLISHED,
        'systemFolderTitle':          $cascadeXML_ELEMENT_TITLE,
        'systemFolderSummary':        $cascadeXML_ELEMENT_SUMMARY,
        'systemFolderAuthor':         $cascadeXML_ELEMENT_AUTHOR,
        'systemFolderTeaser':         $cascadeXML_ELEMENT_TEASER,
        'systemFolderKeywords':       $cascadeXML_ELEMENT_KEYWORDS,
        'systemFolderDescription':    $cascadeXML_ELEMENT_DESCRIPTION,
        'systemFolderStartDate':      $cascadeXML_ELEMENT_START_DATE,
        'systemFolderEndDate':        $cascadeXML_ELEMENT_END_DATE,
        'systemFolderReviewDate':     $cascadeXML_ELEMENT_REVIEW_DATE,
        'systemFolderDisplayName':    $cascadeXML_ELEMENT_DISPLAY_NAME,
        'systemFolderPath':           $cascadeXML_ELEMENT_PATH,
        'systemFolderSite':           $cascadeXML_ELEMENT_SITE,
        'systemFolderLink':           $cascadeXML_ELEMENT_LINK,
        'systemFolderCreatedBy':      $cascadeXML_ELEMENT_CREATED_BY,
        'systemFolderCreatedOn':      $cascadeXML_ELEMENT_CREATED_ON,
        'systemFolderLastModifiedBy': $cascadeXML_ELEMENT_LAST_MODIFIED_BY,
        'systemFolderLastModified':   $cascadeXML_ELEMENT_LAST_MODIFIED,
        'systemFolderLastPublishedOn':$cascadeXML_ELEMENT_LAST_PUBLISHED_ON,
        'systemFolderLastPublishedBy':$cascadeXML_ELEMENT_LAST_PUBLISHED_BY,
        'systemFolderDynamicMetadata':$cascadeXML_ELEMENT_DYNAMIC_METADATA
    } )
    
#set( $systemPageVarElementMap = {
        'systemPageName':           $cascadeXML_ELEMENT_NAME,
        'systemPageIsPublished':    $cascadeXML_ELEMENT_IS_PUBLISHED,
        'systemPageTitle':          $cascadeXML_ELEMENT_TITLE,
        'systemPageSummary':        $cascadeXML_ELEMENT_SUMMARY,
        'systemPageAuthor':         $cascadeXML_ELEMENT_AUTHOR,
        'systemPageTeaser':         $cascadeXML_ELEMENT_TEASER,
        'systemPageKeywords':       $cascadeXML_ELEMENT_KEYWORDS,
        'systemPageDescription':    $cascadeXML_ELEMENT_DESCRIPTION,
        'systemPageStartDate':      $cascadeXML_ELEMENT_START_DATE,
        'systemPageEndDate':        $cascadeXML_ELEMENT_END_DATE,
        'systemPageReviewDate':     $cascadeXML_ELEMENT_REVIEW_DATE,
        'systemPageDisplayName':    $cascadeXML_ELEMENT_DISPLAY_NAME,
        'systemPagePath':           $cascadeXML_ELEMENT_PATH,
        'systemPageSite':           $cascadeXML_ELEMENT_SITE,
        'systemPageLink':           $cascadeXML_ELEMENT_LINK,
        'systemPageCreatedBy':      $cascadeXML_ELEMENT_CREATED_BY,
        'systemPageCreatedOn':      $cascadeXML_ELEMENT_CREATED_ON,
        'systemPageLastModifiedBy': $cascadeXML_ELEMENT_LAST_MODIFIED_BY,
        'systemPageLastModified':   $cascadeXML_ELEMENT_LAST_MODIFIED,
        'systemPageLastPublishedOn':$cascadeXML_ELEMENT_LAST_PUBLISHED_ON,
        'systemPageLastPublishedBy':$cascadeXML_ELEMENT_LAST_PUBLISHED_BY,
        'systemPagePageXhtml':      $cascadeXML_ELEMENT_PAGE_XHTML,
        'systemPageDynamicMetadata':$cascadeXML_ELEMENT_DYNAMIC_METADATA,
        'systemPageSystemDataStructure':$cascadeXML_ELEMENT_SYSTEM_DATA_STRUCTURE
    } )
    
#set( $systemSymlinkVarElementMap = {
        'systemSymlinkName':           $cascadeXML_ELEMENT_NAME,
        'systemSymlinkTitle':          $cascadeXML_ELEMENT_TITLE,
        'systemSymlinkSummary':        $cascadeXML_ELEMENT_SUMMARY,
        'systemSymlinkAuthor':         $cascadeXML_ELEMENT_AUTHOR,
        'systemSymlinkTeaser':         $cascadeXML_ELEMENT_TEASER,
        'systemSymlinkKeywords':       $cascadeXML_ELEMENT_KEYWORDS,
        'systemSymlinkDescription':    $cascadeXML_ELEMENT_DESCRIPTION,
        'systemSymlinkStartDate':      $cascadeXML_ELEMENT_START_DATE,
        'systemSymlinkEndDate':        $cascadeXML_ELEMENT_END_DATE,
        'systemSymlinkReviewDate':     $cascadeXML_ELEMENT_REVIEW_DATE,
        'systemSymlinkDisplayName':    $cascadeXML_ELEMENT_DISPLAY_NAME,
        'systemSymlinkPath':           $cascadeXML_ELEMENT_PATH,
        'systemSymlinkSite':           $cascadeXML_ELEMENT_SITE,
        'systemSymlinkCreatedBy':      $cascadeXML_ELEMENT_CREATED_BY,
        'systemSymlinkCreatedOn':      $cascadeXML_ELEMENT_CREATED_ON,
        'systemSymlinkLastModifiedBy': $cascadeXML_ELEMENT_LAST_MODIFIED_BY,
        'systemSymlinkLastModified':   $cascadeXML_ELEMENT_LAST_MODIFIED,
        'systemSymlinkLink':           $cascadeXML_ELEMENT_LINK,
        'systemSymlinkDynamicMetadata':$cascadeXML_ELEMENT_DYNAMIC_METADATA

    } )

## a prefix used in macro names
#set( $MACRO_PREFIX = 'process' )

## This part can contain business logic. Note that when the Locator Tool is used,
## site name must be provided so that the library code can be imported in other sites.

## read the code templates block, grab the code, and make it available
#set( $global_code_templates_code = $_.locateBlock( 
    "formats/library/velocity/chanw_global_code_templates", $core_site_name ).getXMLAsXMLElement().getChild( "global-code-templates" ) )

## these are code templates used to generate code
#set( $single_group_code    = $global_code_templates_code.getChild( "single-group" ).Value )
#set( $multi_group_code     = $global_code_templates_code.getChild( "multi-group" ).Value )
#set( $site_map_code        = $global_code_templates_code.getChild( "site-map" ).Value )
#set( $macro_foreach_code   = $global_code_templates_code.getChild( "generate-macro-foreach" ).Value )
#set( $index_block_code     = $global_code_templates_code.getChild( "index-block-macro" ).Value )
#set( $site_config_code     = $global_code_templates_code.getChild( "site-config" ).Value )
#set( $page_config_code     = $global_code_templates_code.getChild( "page-config" ).Value )
#set( $process_cascade_api_asset_code = $global_code_templates_code.getChild( "process-cascade-api-asset-code" ).Value )
#set( $get_image_by_page_path_code = $global_code_templates_code.getChild( "get-image-by-page-path-code" ).Value )

## a list of names of variables associated with Velocity code
#set( $chanwCodeList = [
    'get_image_by_page_path_code'
] )

## a macro to execute the blocks of code
#macro( chanwGenerateCode $codeName )
    #set( $chanwStmt = '#set($chanwCode=$' + $codeName + ' )' )
    #evaluate( $chanwStmt )
    #set( $chanwCode = $chanwCode.replaceAll("<", "<").replaceAll(">", ">").replaceAll("-aa-", "&&") )
    #evaluate( $chanwCode )
#end

#foreach( $codeName in $chanwCodeList )
    #chanwGenerateCode( $codeName )
#end
#*
《documentation  id=“bottom”》
《/documentation》
《/code》
*#