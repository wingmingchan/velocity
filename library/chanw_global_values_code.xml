<?xml version="1.0"?>
<global-values>
#*
This block is hooked up with the format chanw_global_values.
The format provides constants used in other library formats,
and populates global variables storing Velocity code.
*#
## special characters
#define( $chanwDOUBLE_HASH )$_EscapeTool.getH()$_EscapeTool.getH()#end
#define( $chanwNEWLINE )$_EscapeTool.n#end
#define( $DOUBLE_HASH )$_EscapeTool.getH()$_EscapeTool.getH()#end
#define( $NEWLINE )$_EscapeTool.n#end

## HTML tags
#define( $S_DIV )&lt;div&gt;#end
#define( $E_DIV )&lt;/div&gt;#end
#define( $S_H1 )&lt;h1&gt;#end
#define( $E_H1 )&lt;/h1&gt;#end
#define( $S_H2 )&lt;h2&gt;#end
#define( $E_H2 )&lt;/h2&gt;#end
#define( $S_H3 )&lt;h3&gt;#end
#define( $E_H3 )&lt;/h3&gt;#end
#define( $S_LI )&lt;li&gt;#end
#define( $E_LI )&lt;/li&gt;#end
#define( $S_P )&lt;p&gt;#end
#define( $E_P )&lt;/p&gt;#end
#define( $S_PRE )&lt;pre&gt;#end
#define( $E_PRE )&lt;/pre&gt;#end
#define( $S_UL )&lt;ul&gt;#end
#define( $E_UL )&lt;/ul&gt;#end
#define( $BR )&lt;br/&gt;#end
#define( $HR )&lt;hr class="lightgray"/&gt;#end

## java class names used for comparison
#set( $COM_CASCADE_BLOCK_API_CLASS_NAME         = "com.hannonhill.cascade.api.adapters.XHTMLDataDefinitionBlockAPIAdapter" )
#set( $COM_CASCADE_METADATA_CLASS_NAME          = "com.hannonhill.cascade.api.adapters.MetadataAPIAdapter" )
#set( $COM_CASCADE_PAGE_API_CLASS_NAME          = "com.hannonhill.cascade.api.adapters.PageAPIAdapter" )
#set( $COM_CASCADE_STRUCTURED_DATA_NODE_CLASS_NAME = "com.hannonhill.cascade.api.adapters.StructuredDataNodeAPIAdapter" )
#set( $COM_CASCADE_STRUCTURED_DATA_LIST_CLASS_NAME = "[Lcom.hannonhill.cascade.api.asset.common.StructuredDataNode;" )
#set( $JAVA_LANG_STRING_CLASS_NAME              = 'java.lang.String' )
#set( $JAVA_UTIL_ARRAY_LIST_CLASS_NAME          = 'java.util.ArrayList' )
#set( $JAVA_UTIL_LINKEDHASHMAP_CLASS_NAME       = 'java.util.LinkedHashMap' )
#set( $JAVA_UTIL_HASHMAP_CLASS_NAME             = 'java.util.HashMap' )
#set( $ORG_JDOM_DOCUMENT_CLASS_NAME             = 'org.jdom.Document' )
#set( $ORG_JDOM_ELEMENT_CLASS_NAME              = 'org.jdom.Element' )

## cascade pseudo tags
#set( $S_SYSTEM_ASSET       = "[" + "system-asset]" )
#set( $E_SYSTEM_ASSET       = "[" + "/system-asset]" )
#set( $S_SYSTEM_ASSET_LOCAL = "[" + "system-asset:local]" )
#set( $E_SYSTEM_ASSET_LOCAL = "[" + "/system-asset:local]" )

## cascade element names
#set( $cascadeXML_ELEMENT_CREATED_BY            = 'created-by' )
#set( $cascadeXML_ELEMENT_CREATED_ON            = 'created-on' )
#set( $cascadeXML_ELEMENT_DISPLAY_NAME          = 'display-name' )
#set( $cascadeXML_ELEMENT_DYNAMIC_METADATA      = 'dynamic-metadata' )
#set( $cascadeXML_ELEMENT_FILE_SIZE             = 'file-size' )
#set( $cascadeXML_ELEMENT_IS_PUBLISHED          = 'is-published' )
#set( $cascadeXML_ELEMENT_LAST_MODIFIED_BY      = 'last-modified-by' )
#set( $cascadeXML_ELEMENT_LAST_MODIFIED         = 'last-modified' )
#set( $cascadeXML_ELEMENT_LAST_PUBLISHED_BY     = 'last-published-by' )
#set( $cascadeXML_ELEMENT_LAST_PUBLISHED_ON     = 'last-published-on' )
#set( $cascadeXML_ELEMENT_LINK                  = 'link' )
#set( $cascadeXML_ELEMENT_NAME                  = 'name' )
#set( $cascadeXML_ELEMENT_PATH                  = 'path' )
#set( $cascadeXML_ELEMENT_PAGE_XHTML            = 'page-xhtml' )
#set( $cascadeXML_ELEMENT_SITE                  = 'site' )
#set( $cascadeXML_ELEMENT_START_DATE            = 'start-date' )
#set( $cascadeXML_ELEMENT_SUMMARY               = 'summary' )
#set( $cascadeXML_ELEMENT_SYSTEM_BLOCK          = 'system-block' )
#set( $cascadeXML_ELEMENT_SYSTEM_DATA_STRUCTURE = 'system-data-structure' )
#set( $cascadeXML_ELEMENT_SYSTEM_FILE           = 'system-file' )
#set( $cascadeXML_ELEMENT_SYSTEM_FOLDER         = 'system-folder' )
#set( $cascadeXML_ELEMENT_SYSTEM_INDEX_BLOCK    = 'system-index-block' )
#set( $cascadeXML_ELEMENT_SYSTEM_PAGE           = 'system-page' )
#set( $cascadeXML_ELEMENT_SYSTEM_SYMLINK        = 'system-symlink' )
#set( $cascadeXML_ELEMENT_SYSTEM_XML            = 'system-xml' )
#set( $cascadeXML_ELEMENT_TITLE                 = 'title' )
#set( $chanwFolderContainedAssets = [ $cascadeXML_ELEMENT_SYSTEM_BLOCK, 
    $cascadeXML_ELEMENT_SYSTEM_FILE, $cascadeXML_ELEMENT_SYSTEM_FOLDER,
    $cascadeXML_ELEMENT_SYSTEM_PAGE, $cascadeXML_ELEMENT_SYSTEM_SYMLINK ] )

## RSS
#set( $rssXML_ELEMENT_CHANNEL                   = 'channel' )
#set( $rssXML_ELEMENT_DESCRIPTION               = 'description' )
#set( $rssXML_ELEMENT_GUID                      = 'guid' )
#set( $rssXML_ELEMENT_ITEM                      = 'item' )
#set( $rssXML_ELEMENT_LINK                      = 'link' )
#set( $rssXML_ELEMENT_PUB_DATE                  = 'pubDate' )
#set( $rssXML_ELEMENT_TITLE                     = 'title' )

## HTML element names, used in processing data definition blocks
#* 'link', 'summary', 'title' are omitted from this list because they are used in Cascade.
Otherwise, when an element is encountered, it is assumed to be in a wysiwyg and the element
is part of the HTML markups.
*#
#set( $chanwHTMLElements = [
    'a', 'abbr', 'address', 'area', 'article', 'aside', 'audio', 
    'b', 'base', 'bdi', 'bdo', 'blockquote', 'body', 'br', 'button', 
    'canvas', 'caption', 'cite', 'code', 'col', 'colgroup',
    'datalist', 'dd', 'del', 'details', 'dfn', 'dialog',  'div','dl', 'dt',
    'em', 'embed', 'fieldset', 'figcaption', 'figure', 'footer', 'form',
    'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'head', 'header', 'hr', 'html',
    'i', 'iframe', 'img', 'input', 'ins', 'kdb', 'keygen',
    'label', 'legend', 'li',
    'main', 'map', 'mark', 'menu',  'menuitem', 'meta','meter', 'nav', 'noscript', 
    'object', 'ol', 'optgroup', 'option', 'output',
    'p', 'param', 'pre', 'progress', 'q', 'rp', 'rt', 'ruby', 
    's', 'samp', 'script', 'section', 'select', 'small', 'source', 'span', 'strong',
    'style', 'sub', 'sup', 
    'table', 'tbody', 'td', 'textarea', 'tfoot', 'th', 'thead', 'time',
    'tr','track', 'u', 'ul', 'var', 'video', 'wbr'
] )

## date and calendar
#set( $chanwYearField     = $_FieldTool.in( 'java.util.Calendar' ).YEAR )
#set( $chanwMonthField    = $_FieldTool.in( 'java.util.Calendar' ).MONTH )
#set( $chanwDayField      = $_FieldTool.in( 'java.util.Calendar' ).DATE )
#set( $chanwHourField     = $_FieldTool.in( 'java.util.Calendar' ).HOUR )
#set( $chanwMinuteField   = $_FieldTool.in( 'java.util.Calendar' ).MINUTE )
#set( $chanwSecondField   = $_FieldTool.in( 'java.util.Calendar' ).SECOND )
#set( $chanwAmPmField     = $_FieldTool.in( 'java.util.Calendar' ).AM_PM )

#set( $chanwTodayDateObject          = $_DateTool.getSystemDate() )
#set( $chanwCalendarObject           = $_DateTool.getCalendar() )
#set( $chanwCurrentTimestampLong     = $_DateTool.getSystemTime() )
#set( $chanwCurrentTimestampString   = "" + $_DateTool.getSystemTime() )
#set( $chanwCurrentYearInt           = $_DateTool.getYear() )
#set( $chanwCurrentMonthInt          = $_DateTool.getMonth() )
#set( $chanwCurrentDayInt            = $_DateTool.getDay() )
#set( $chanwCurrentHourInt           = $_DateTool.getValue( $chanwHourField, $chanwTodayDateObject ) )
#set( $chanwCurrentMinuteInt         = $_DateTool.getValue( $chanwMinuteField, $chanwTodayDateObject ) )
#set( $chanwCurrentSecondInt         = $_DateTool.getValue( $chanwSecondField, $chanwTodayDateObject ) )
#set( $chanwCurrentAmPmString        = $_DateTool.getValue( $chanwAmPmField, $chanwTodayDateObject ) )

#set( $chanwCurrentMonthLongString   = $_DateTool.format( "MMMMM", $_DateTool.getSystemDate() ) )
#set( $chanwCurrentMonthMediumString = $_DateTool.format( "MMM", $_DateTool.getSystemDate() ) )

#set( $rssItemVarElementMap = {
        'rssItemGuid':       $rssXML_ELEMENT_GUID,
        'rssItemTitle':      $rssXML_ELEMENT_TITLE,
        'rssItemLink':       $rssXML_ELEMENT_LINK,
        'rssItemPubDate':    $rssXML_ELEMENT_PUB_DATE,
        'rssItemDescription':$rssXML_ELEMENT_DESCRIPTION
    } )

#set( $systemBlockVarElementMap = {
        'systemBlockName':           $cascadeXML_ELEMENT_NAME,
        'systemBlockPath':           $cascadeXML_ELEMENT_PATH,
        'systemBlockSite':           $cascadeXML_ELEMENT_SITE,
        'systemBlockCreatedBy':      $cascadeXML_ELEMENT_CREATED_BY,
        'systemBlockCreatedOn':      $cascadeXML_ELEMENT_CREATED_ON,
        'systemBlockLastModifiedBy': $cascadeXML_ELEMENT_LAST_MODIFIED_BY,
        'systemBlockLastModified':   $cascadeXML_ELEMENT_LAST_MODIFIED
    } )
   
#set( $systemFileVarElementMap = {
        'systemFileName':           $cascadeXML_ELEMENT_NAME,
        'systemFileIsPublished':    $cascadeXML_ELEMENT_IS_PUBLISHED,
        'systemFileLastPublishedOn':$cascadeXML_ELEMENT_LAST_PUBLISHED_ON,
        'systemFileLastPublishedBy':$cascadeXML_ELEMENT_LAST_PUBLISHED_BY,
        'systemFilePath':           $cascadeXML_ELEMENT_PATH,
        'systemFileSite':           $cascadeXML_ELEMENT_SITE,
        'systemFileLink':           $cascadeXML_ELEMENT_LINK,
        'systemFileCreatedBy':      $cascadeXML_ELEMENT_CREATED_BY,
        'systemFileCreatedOn':      $cascadeXML_ELEMENT_CREATED_ON,
        'systemFileLastModifiedBy': $cascadeXML_ELEMENT_LAST_MODIFIED_BY,
        'systemFileLastModified':   $cascadeXML_ELEMENT_LAST_MODIFIED,
        'systemFileSize':           $cascadeXML_ELEMENT_FILE_SIZE
    } )

#set( $systemFolderVarElementMap = {
        'systemFolderName':           $cascadeXML_ELEMENT_NAME,
        'systemFolderIsPublished':    $cascadeXML_ELEMENT_IS_PUBLISHED,
        'systemFolderLastPublishedOn':$cascadeXML_ELEMENT_LAST_PUBLISHED_ON,
        'systemFolderLastPublishedBy':$cascadeXML_ELEMENT_LAST_PUBLISHED_BY,
        'systemFolderTitle':          $cascadeXML_ELEMENT_TITLE,
        'systemFolderDisplayName':    $cascadeXML_ELEMENT_DISPLAY_NAME,
        'systemFolderPath':           $cascadeXML_ELEMENT_PATH,
        'systemFolderSite':           $cascadeXML_ELEMENT_SITE,
        'systemFolderLink':           $cascadeXML_ELEMENT_LINK,
        'systemFolderCreatedBy':      $cascadeXML_ELEMENT_CREATED_BY,
        'systemFolderCreatedOn':      $cascadeXML_ELEMENT_CREATED_ON,
        'systemFolderLastModifiedBy': $cascadeXML_ELEMENT_LAST_MODIFIED_BY,
        'systemFolderLastModified':   $cascadeXML_ELEMENT_LAST_MODIFIED
    } )
    
#set( $systemPageVarElementMap = {
        'systemPageName':           $cascadeXML_ELEMENT_NAME,
        'systemPageIsPublished':    $cascadeXML_ELEMENT_IS_PUBLISHED,
        'systemPageLastPublishedOn':$cascadeXML_ELEMENT_LAST_PUBLISHED_ON,
        'systemPageLastPublishedBy':$cascadeXML_ELEMENT_LAST_PUBLISHED_BY,
        'systemPageTitle':          $cascadeXML_ELEMENT_TITLE,
        'systemPageSummary':        $cascadeXML_ELEMENT_SUMMARY,
        'systemPageStartDate':      $cascadeXML_ELEMENT_START_DATE,
        'systemPageDisplayName':    $cascadeXML_ELEMENT_DISPLAY_NAME,
        'systemPagePath':           $cascadeXML_ELEMENT_PATH,
        'systemPageSite':           $cascadeXML_ELEMENT_SITE,
        'systemPageLink':           $cascadeXML_ELEMENT_LINK,
        'systemPageCreatedBy':      $cascadeXML_ELEMENT_CREATED_BY,
        'systemPageCreatedOn':      $cascadeXML_ELEMENT_CREATED_ON,
        'systemPageLastModifiedBy': $cascadeXML_ELEMENT_LAST_MODIFIED_BY,
        'systemPageLastModified':   $cascadeXML_ELEMENT_LAST_MODIFIED,
        'systemPagePageXhtml':      $cascadeXML_ELEMENT_PAGE_XHTML
    } )
    
#set( $systemSymlinkVarElementMap = {
        'systemSymlinkName':           $cascadeXML_ELEMENT_NAME,
        'systemSymlinkPath':           $cascadeXML_ELEMENT_PATH,
        'systemSymlinkSite':           $cascadeXML_ELEMENT_SITE,
        'systemSymlinkCreatedBy':      $cascadeXML_ELEMENT_CREATED_BY,
        'systemSymlinkCreatedOn':      $cascadeXML_ELEMENT_CREATED_ON,
        'systemSymlinkLastModifiedBy': $cascadeXML_ELEMENT_LAST_MODIFIED_BY,
        'systemSymlinkLastModified':   $cascadeXML_ELEMENT_LAST_MODIFIED,
        'systemSymlinkLink':           $cascadeXML_ELEMENT_LINK
    } )

## This part can contain business logic. Note that when the Locator Tool is used,
## site name must be provided so that the library code can be imported in other sites.
## read the block and grab the code
#set( $global_velocity_code = $_.locateBlock( 
    "formats/library/velocity/chanw_global_velocity_code", $master_site_name ).getXMLAsXMLElement().getChild( "global-velocity-code" ) )
    
## these are code templates used to generate code
#set( $single_group_code    = $global_velocity_code.getChild( "single-group" ).value )
#set( $multi_group_code     = $global_velocity_code.getChild( "multi-group" ).value )
#set( $site_map_code        = $global_velocity_code.getChild( "site-map" ).value )
#set( $macro_foreach_code   = $global_velocity_code.getChild( "generate-macro-foreach" ).value )
#set( $index_block_code     = $global_velocity_code.getChild( "index-block-macro" ).value )
#set( $site_config_code     = $global_velocity_code.getChild( "site-config" ).value )
#set( $page_config_code     = $global_velocity_code.getChild( "page-config" ).value )

## these are macros used to process block choosers and various types of blocks
#set( $processBlockChooser_code        = $global_velocity_code.getChild( "processBlockChooser" ).value )
#set( $processDataDefinitionBlock_code = $global_velocity_code.getChild( "processDataDefinitionBlock" ).value )
#set( $processIndexBlock_code          = $global_velocity_code.getChild( "processIndexBlock" ).value )
#set( $processScript_code              = $global_velocity_code.getChild( "processScript" ).value )
#set( $processParams_code              = $global_velocity_code.getChild( "processParams" ).value )

## these are macros providing general utilities
#set( $build_xml_content_root_code           = $global_velocity_code.getChild( "build-xml-content-root-code" ).value )
#set( $call_java_method_code                 = $global_velocity_code.getChild( "call-java-method-code" ).value )
#set( $convert_to_pascal_case_code           = $global_velocity_code.getChild( "convert-to-pascal-case-code" ).value )
#set( $get_file_path_code                    = $global_velocity_code.getChild( "get-file-path-code" ).value )
#set( $get_node_values_code                  = $global_velocity_code.getChild( "get-node-values-code" ).value )
#set( $get_node_sets_code                    = $global_velocity_code.getChild( "get-node-sets-code" ).value )
#set( $invoke_macro_code                     = $global_velocity_code.getChild( "invoke-macro-code" ).value )
#set( $locate_asset_code                     = $global_velocity_code.getChild( "locate-asset-code" ).value )
#set( $reinitialize_list_of_variables_code   = $global_velocity_code.getChild( "reinitialize-list-of-variables-code" ).value )
#set( $set_variable_code                     = $global_velocity_code.getChild( "set-variable-code" ).value )
#set( $set_variable_to_non_empty_string_code = $global_velocity_code.getChild( "set-variable-to-non-empty-string-code" ).value )
#set( $create_database_php_code_code         = $global_velocity_code.getChild( "create-database-php-code-code" ).value )
#set( $get_database_list_code                = $global_velocity_code.getChild( "get-database-list-code" ).value )

## these are macros providing services related to lists and maps
#set( $get_list_reversed_code          = $global_velocity_code.getChild( "get-list-reversed-code" ).value )
#set( $get_map_key_value_reversed_code = $global_velocity_code.getChild( "get-map-key-value-reversed-code" ).value )

## these are macros providing services to work with Cascade API objects
#set( $get_folder_contained_asset_name_code = $global_velocity_code.getChild( "get-folder-contained-asset-name-code" ).value )

## general utilities
#set( $MACRO_PREFIX = 'process' )
#evaluate( $build_xml_content_root_code )
#evaluate( $call_java_method_code )
#evaluate( $convert_to_pascal_case_code )
#evaluate( $get_file_path_code )
#evaluate( $get_node_values_code )
#evaluate( $get_node_sets_code )
#evaluate( $invoke_macro_code )
#evaluate( $reinitialize_list_of_variables_code )
#evaluate( $set_variable_code )
#evaluate( $set_variable_to_non_empty_string_code )
#evaluate( $create_database_php_code_code )
#evaluate( $get_database_list_code )

## list and map utilities
#set( $get_list_reversed_code = $get_list_reversed_code.replaceAll( "&amp;lt;", "&lt;" ).replaceAll( "&amp;gt;", "&gt;" ).replaceAll( "-aa-", "&amp;&amp;" ) )
#evaluate( $get_list_reversed_code )
#set( $get_map_key_value_reversed_code = $get_map_key_value_reversed_code.replaceAll( "&amp;lt;", "&lt;" ).replaceAll( "&amp;gt;", "&gt;" ).replaceAll( "-aa-", "&amp;&amp;" ) )
#evaluate( $get_map_key_value_reversed_code )

## Cascade API utilities
#evaluate( $get_folder_contained_asset_name_code )
#evaluate( $locate_asset_code )

</global-values>